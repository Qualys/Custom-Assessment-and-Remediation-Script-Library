$VunVersions = @("18.12.407.0","18.12.416.0") 
$3cx = Get-WmiObject -Class Win32_Product -Filter "Name = '3CX Desktop App'"
if ($3cx) {
if ($VunVersions -contains $3cx.Version) {
Write-Host "vulnerable version of 3CX found on the host"
$uninstallResult = $3cx.Uninstall()
if ($uninstallResult.ReturnValue -eq 0) {
Write-Host "3CX Desktop App uninstalled successfully"
$returnCode = 1337
} else {
Write-Host "Failed to uninstall"
$returnCode = $uninstallResult.ReturnValue
}
} else {
Write-Host "'3CX Desktop App' version is not vulnerable"
}
exit $returnCode
} else {
Write-Host "'3CX Desktop App' is not installed"
}
