# Download Text4Scan.zip file
Invoke-WebRequest -Uri "https://github.com/Qualys/Custom-Assessment-and-Remediation-Script-Library/blob/main/Zero%20Day/CVE-2022(OpenSSL)/OpenSSLScan.exe" -UseBasicParsing -OutFile $env:TEMP\OpenSSLScan.exe
# Unzip downloaded file
#Expand-Archive $env:TEMP\Text4Scan.zip -DestinationPath $env:TEMP\

# Start scan process
cd $env:TEMP\
.\OpenSSLScan.exe /scan /report_sig | Out-Null

Get-Content C:\ProgramData\Qualys\Text4Scan\findings.out
""
""
Get-Content C:\ProgramData\Qualys\Text4Scan\summary.out
    $vulnerabilitiesFound = Get-Content C:\ProgramData\Qualys\Text4Scan\summary.out | Select-String -Pattern "vulnerabilitiesFound:"
    $vuln=$vulnerabilitiesFound -split ": "
if ( $vuln[1] -gt 0)
{
    Exit 1337
}
else
{
    Exit 0
}